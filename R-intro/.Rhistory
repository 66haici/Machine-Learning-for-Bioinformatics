library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(0,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text(x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(0,3,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text(x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(0,0,3,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text(x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(3,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text(x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(3,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text(x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(0,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text(x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(2,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text(x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(2,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
dev.new(width=5, height=4)
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text(x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(2,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
dev.new(width=5, height=6)
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text(x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(2,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
dev.new(width=5, height=10)
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text(x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(2,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text(fit, use.n=TRUE, x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(2,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text( use.n=TRUE, x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(2,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text( all=TRUE, x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(oma=c(2,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs', margin = 0.2)
labs <- homolog_groups
text( x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(mar=c(5,4,4,2)+0.2)
par(oma=c(2,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text( x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
par(mar=c(5,4,4,2)+0.2)
#par(oma=c(2,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text( x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
#par(mar=c(5,4,4,2)+0.2)
par(oma=c(2,0,0,0))  # all sides have 3 lines of space
par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text( x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(lattice)
counts <- c(43, 43, 43, 870, 43, 47, 870, 883, 43, 43, 870, 47, 887, 870, 887, 887)
homolog_groups <- c('All families', 'Ortho & Inpara & Between out', 'Ortho & Inpara & Withint Out', 'Ortho & Between out & Within out', 'Inpara & Between out & Within out', 'Ortho & Inpara','Ortho Between Out',
'Ortho & Within out',
'Inpara & Between Out',
'Inpara & Within out',
'Between out Within out',
'Inpara',
'Ortho',
'Within out',
'Between out'
)
df <- data.frame((row.names = c('homolog groups')), family_frequencies = counts )
#par(mar=c(5,4,4,2)+0.2)
par(oma=c(2,0,0,0))  # all sides have 3 lines of space
#par(pty = "s")
x <- barplot(df$family_frequencies,
args.legend = list(x = "topleft", bty="n"), main = 'frequency of families having different homologs')
labs <- homolog_groups
text( x=x, y=par()$usr[3]+0.01*(par()$usr[4]-par()$usr[3]),
labels=labs, srt=30, adj=1, xpd=TRUE, cex = 0.9)
library(ggtree)
setwd("~/Box Sync/Associate_Instructor/I529/labs/R-intro")
data <- read.csv("binary.csv")
data
size(data)
length(data)
length(data[0])
data[0]
length(data$admit)
dim(data)
#sample 200 values from a gaussian distribution with mean=10, sd=2
x.norm <- rnorm(n=200, m=10, sd=2)
#specify the layout
nf <- layout(matrix(c(1,2,3,4), 2, 2, byrow=TRUE), respect=TRUE)
layout.show(nf)
#hisogram
hist(x.norm, breaks=20, main="Histogram", xlab="X")
#density plot
plot(density(x.norm, kernel="gaussian"), main="Density plot", xlab="X")
#density function
m <- mean(x.norm)
v <- sd(x.norm)
yfit <- dnorm(xfit, mean=mean(x.norm), sd=sd(x.norm))
xfit <- seq(0, 20, 0.001)
plot(xfit, yfit, type="l", main="PDF", xlab="X", ylab="f(X)")
#cumulative probability function
yfit <- pnorm(xfit, mean=mean(x.norm), sd=sd(x.norm))
plot(xfit, yfit, type="l", main="CDF", xlab="X", ylab="P(X)")
x.norm <- rnorm(n=200, m=10, sd=2)
nf <- layout(matrix(c(1,2,3,4), 2, 2, byrow=TRUE), respect=TRUE)
layout.show(nf)
hist(x.norm, breaks=20, main="Histogram", xlab="X")
plot(density(x.norm, kernel="gaussian"), main="Density plot", xlab="X")
m <- mean(x.norm)
v <- sd(x.norm)
yfit <- dnorm(xfit, mean=mean(x.norm), sd=sd(x.norm))
xfit <- seq(0, 20, 0.001)
plot(xfit, yfit, type="l", main="PDF", xlab="X", ylab="f(X)")
#cumulative probability function
yfit <- pnorm(xfit, mean=mean(x.norm), sd=sd(x.norm))
plot(xfit, yfit, type="l", main="CDF", xlab="X", ylab="P(X)")
library(MASS)
mge_host_viz <- function(inputfile="lm-demo.txt", savefile="",legendpos="topleft") {
data <- read.table(inputfile)
colnames(data) <- c("sample", "host", "mge")
#estimate outlier (using Cook's distance)
lm.fitted <- lm(data[[3]] ~ data[[2]])
r <- stdres(lm.fitted)
d1 <- cooks.distance(lm.fitted)
rabs <- abs(r)
a <- cbind(data, d1, r, rabs)
sample <- length(data[[1]])
outlier <- a[d1 > 4/sample, ]
#sort by abs of residual
outliersorted <- outlier[order(-outlier$rabs), ]
outliernum <- length(outlier[[1]])
if(savefile != "") pdf(savefile, 7, 5)
stepy <- (max(data[[3]]) - min(data[[3]])) / 10
offsety <- stepy / 3
plot(data[[2]],data[[3]],xlab="Host genome abundance", ylab="Virus abundance")
thissample <- substr(inputfile, 1, 9)
tmp <- subset(data, sample==thissample)
points(tmp[[2]][1], tmp[[3]][1], col="red",pch=16)
text(tmp[[2]][1], tmp[[3]][1]+offsety, col="black", thissample)
displayn <- 1
#the first three outliers
if (outliernum >= 1) {
for(i in 1:min(displayn, outliernum)) {
points(outliersorted[[2]][i], outliersorted[[3]][i], col="green",pch=16)
offsetx <- 0
if(outliersorted[[2]][i] > max(data[[2]]) * 0.9) offsetx <- max(data[[2]]) * 0.1
if(outliersorted[[2]][i] < max(data[[2]]) * 0.1) offsetx <- -1 * max(data[[2]]) * 0.1
text(outliersorted[[2]][i]-offsetx, outliersorted[[3]][i]-offsety, as.character(outliersorted[[1]][i]))
}
}
rr.huber <- rlm(data[[3]] ~ data[[2]])
abline(coef=c(0, 1), col="black")
abline(coef=lm.fitted$coef, col="green")
abline(coef=rr.huber$coef, col="red")
leg.txt <- c("1:1", sprintf("lm: coef=%.2f", lm.fitted$coef[2]), sprintf("rlm: coef=%.2f", rr.huber$coef[2]))
leg.col <- c("black", "green", "red")
legend(legendpos, legend = leg.txt, col=leg.col, lty=1, merge=TRUE, inset = .05)
if(savefile != "") dev.off()
}
mge_host_viz()
#ref: http://www.ats.ucla.edu/stat/r/dae/logit.htm
student <- read.csv("binary.csv")
student$rank <- factor(student$rank) #rank as categorical
summary(student)
#use family defines error distribution & model
glm.out <- glm(admit ~ gre + gpa + rank, data=student, family=binomial(link=logit))
summary(glm.out)
#intepret the coefficients, examples
#For every one unit change in gre, the log odds of admission (versus non-admission) increases by 0.002
#For rank, having rank of 2, versus 1, decreases the log odds of admission by -0.675
exp(coef(glm.out))
#use exp to transform back to odd-ratio
newdata <- with(student, data.frame(gre = c(790, 469), gpa = c(3.9, 2.8), rank = factor(c(1, 4))))
newdata$rankP <- predict(glm.out, newdata=newdata,type="response")
newdata
student
newdata
#ref: http://www.ats.ucla.edu/stat/r/dae/logit.htm
student <- read.csv("binary.csv")
student$rank <- factor(student$rank) #rank as categorical
summary(student)
#use family defines error distribution & model
glm.out <- glm(admit ~ gre + gpa + rank, data=student, family=binomial(link=logit))
summary(glm.out)
#intepret the coefficients, examples
#For every one unit change in gre, the log odds of admission (versus non-admission) increases by 0.002
#For rank, having rank of 2, versus 1, decreases the log odds of admission by -0.675
exp(coef(glm.out))
#use exp to transform back to odd-ratio
newdata <- with(student, data.frame(gre = c(790, 469), gpa = c(3.9, 2.8), rank = factor(c(1, 4))))
newdata$rankP <- predict(glm.out, newdata=newdata,type="response")
newdata
setwd("~/Box Sync/Associate_Instructor/I529/labs/R-intro")
rdata = load('Sce_CellRanger.RData')
rdata
rdata
rdata = load('Sce_CellRanger.RData', ex <- new.env())
ls.str(ex)
rdata
rdata = load('Sce_Dataset1.RData', ex <- new.env())
rdata
rdata = load('Sce_CellRanger.RData', ex <- new.env())
biocLite("splatter")
if (!requireNamespace("BiocManager"))
install.packages("BiocManager")
BiocManager::install()
biocLite("splatter")
source("http://bioconductor.org/biocLite.R")
if (!requireNamespace("BiocManager"))
install.packages("BiocManager")
BiocManager::install()
biocLite("splatter")
rdata = load('Sce_CellRanger.RData', ex <- new.env())
rdata
library(MUDAN)
require(devtools)
devtools::install_github("JEFworks/MUDAN")
install.packages("devtools")
require(devtools)
devtools::install_github("JEFworks/MUDAN")
