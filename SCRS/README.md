
#### Clustering and Analyzing Single Cell RNA sequencing.

Single-cell RNA sequencing examines the gene expression level of individual cells in a given population by simultaneously measuring the mRNA concentration of hundreds to thousands of genes. Heterogenous cell populations, coming from different tissues that are sequenced and quantified together, makes reconstruction of cellular developmental trajectories and modelling of transcriptional dynamicsd difficult and impossoble, however they are made possible through analysis of single cell transcriptomic data.

Traditional and previous genomic studies are limited as they provide measurements for whole tissues and as a result show an average expression profile for all the constituent cells. In multicellular organisms different cell types within the same population can have distinct roles and form subpopulations with different transcriptional profiles. Correlations in the gene expression of the subpopulations can often be missed due to the lack of subpopulation identification. Such technique fail to identify if a change in the expression profile is due to a change in regulation or composition, in which one cell type arises to dominate the population. 

The general experimental steps for Single Cell RNA sequencing would be:
* solating single cells
  * isolate and amplify cells for single-cell analysis. Low throughput techniques and High throughput techniques available
* Quantitative PCR
  * To measure the level of expression of each transcript qPCR can be applied
* Single-cell RNA-seq:
  * The RNA-seq approach is generally regarded as the most precise method to measure the levels of transcripts and is able to generate data for tens of thousands of genes i.e the whole transcriptome

#### Data analysis.

Analysis on single-cell data analysis assumes that the input is a matrix of normalised gene expression counts, generated by the approaches discussed above, and can provide opportunities that are not obtainable by multiple tissue sequencing approaches.

Three main insights provided:

* Identification and characterization of cell types and their spatial organisation in time
* Inference of gene regulatory networks and their strength across individual cells
* Classification of the stochastic component of transcription

##### Clustering
Clustering allows for the formation of subgroups in the cell population. Cells can be clustered by their transcriptomic profile in order to analyse the sub-population structure and identify rare cell types or cell subtypes. Alternatively, genes can be clustered by their expression states in order to identify covarying genes. A combination of both clustering approaches, known as biclustering, has been used to simultaneously cluster by genes and cells to find genes that behave similarly within cell clusters.
Clustering methods applied can be K-means clustering, forming disjoint groups or Hierarchical clustering, forming nested partitions.

##### Biclustering
Biclustering provides several advantages by improving the resolution of clustering. Genes that are only informative to a subset of cells and are hence only expressed there can be identified through biclustering. Moreover, similarly behaving genes that differentiate one cell cluster from another can be identified using this method.

##### Dimensionality reduction
Dimensionality reduction algorithms such as Principal component analysis (PCA) can be used to simplify data for visualisation and pattern detection by transforming cells from a high to a lower dimensional space. The result of this method produces graphs with each cell as a point in a 2-D or 3-D space. Dimensionality reduction is frequently used before clustering as cells in high dimensions can wrongly appear to be close due to distance metrics behaving non-intuitively.

##### Principal component analysis
The most frequently used technique is PCA, which identifies the directions of largest variance principal components and transforms the data so that the first principal component has the largest possible variance, and successive principle components in turn each have the highest variance possible while remaining orthogonal to the preceding components. The contribution each gene makes to each component is used to infer which genes are contributing the most to variance in the population and are involved in differentiating different subpopulations

In this lab we will practice some dimensionality reduction of data sets and clustering them based on their expression profiles.

Assuming we have gene sets from different cells and their expression data (RNA-seq), and we have aligned and quantified our single cell RNA-seq data, we checked for quality control, trimmed low quality reads got rid of the short ones etc... and have obtained tables where it has cells and their RNA quantification information. 
Now we want to identify transcriptional clusters from these tables. Many clustering algorithms exist that are specialized in different tasks, however the underlying techniques are still based on classical clustering algorithms such as K-means, graph based, density-based or hierarchical clustering methods.

we will use some of these approaches alongside with dimensionality reduction techniques in order to clean normalize and cluster our data. For this purpose we're going to use Patient V PBMC single cell RNA-seq data from 10x genomics. For more details about the dataset please visit [here](https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/frozen_pbmc_donor_b) .
We also have previous knowledge about this dataset, because we know what cell-types must be present and a number of markers for these cell-types are available such as CD3E for T-cells, CD19 and CD20 for B-cells, etc. This knowledge will be used for sanity checks and to check the validity of our clustering results later.

 ##### Data preparation
 We will start this lab by following the R-script we have [here](single_cell_RNAseq.R) 
